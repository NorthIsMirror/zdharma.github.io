<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Text Editor In 30 Minutes</title>
  <meta name="description" content="ZUI’s architecture has proven its value. I have only superficially tried to write a text editor in it, and it waselevated in about 30 minutes. Multiple text-...">
  
  <link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">
  <link type="text/css" rel="stylesheet" href="/assets/main-d89a63b8c00d0ddc30122392f2d5c8982ea1ae05843d1d6dab1b1aa188622f20.css" integrity="sha384-czJxw/UikpJ08EtlSD/cFOj289xb7eHSRI8VP1d3fgJE+jhGEVUjodQTNbuMoVii" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
  <link rel="canonical" href="http://zdharma.org/posts/Text-Editor-In-30-Minutes">
  <link rel="alternate" type="application/rss+xml" title="Zdharma Initiative" href="http://zdharma.org/feed.xml">
</head>


<body><div class="single-post-content" id="single-post-content">
    <div class="paper-wrapper" id="post-static-content" style="-webkit-tap-highlight-color:rgba(0,0,0,0);-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;background-color:#303030;box-shadow:0 14px 45px rgba(0, 0, 0, 0.25),
         0 10px 18px rgba(0, 0, 0, 0.22);border-radius:2px;mui-prepared:;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;color:#fafafa;">
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
            <header class="post-header">
                <h1 class="post-title" itemprop="name headline">Text Editor In 30 Minutes</h1>
                <p class="post-meta"><time datetime="{`2017-03-19T15:36:00+01:00`}" itemprop="datePublished">Mar 19, 2017</time></p>
            </header>
            <div class="post-content" itemprop="articleBody"><p>ZUI’s architecture has proven its value. I have only superficially tried to write a text editor in it, and it was
elevated in about 30 minutes. Multiple text-fields, one for each line of text from input file – and that’s pretty it.
Saving file is a breeze with inline-handlers:</p>

<div class="language-zsh highlighter-rouge"><pre class="highlight"><code>-zui_std_rc_button <span class="s2">"bsave"</span> <span class="s2">"Save"</span> <span class="s1">'internal=1; print -rl -- "${lines[@]}" &gt; $edited_file'</span>
</code></pre>
</div>

<p>The code in apostrophes will be invoked on press of the button. Creating text fields for each line of text from input
file is also easy:</p>

<div class="language-zsh highlighter-rouge"><pre class="highlight"><code>noglob -zui_std_text_field <span class="s2">"tfield</span><span class="k">${</span><span class="nv">idx</span><span class="k">}</span><span class="s2">"</span> width offset lines[<span class="nv">$idx</span><span class="o">]</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">noglob</code> causes <code class="highlighter-rouge">line[$idx]</code> to be treated as text and not as pattern. So, a hyper-link is created, with
backend-variable <code class="highlighter-rouge">line[&lt;line-number&gt;]</code> – which is single entry in array to which we read the whole file.</p>

<p>The text editor supports 1000 lines on current Zshells. I have submitted optimizations that make this 6000 lines – they
will be rolled out in next release (5.3.2). Main use case of such text-area is IMO editing of small config file in a
deploy tool, where you change only e.g. an IP, and press “Deploy” to run main task. That’s why 1000 lines is enough, and
6000 even better.</p>

<p>Check out recorded <a href="https://asciinema.org/a/107800">demo</a> of this text editor.</p>
</div>
        </article>
    </div>
</div>
    <div id="root"></div>
</body>
<script src="http://zdharma.org/assets/js/bundle.js" type="text/javascript"></script>

</html>